<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper
  PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
  "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<!-- parameterType(전달값):해당 쿼리문에 전달될 파라미터의 패키지 경로를 포함한 전체 클래스명이나 별칭 -->
<!-- resultType(결과값):해당 쿼리 결과값을 리턴하는 타입의 패키지 경로를 포함한 전체 클래스명이나 별칭 -->
<mapper namespace="board">
	<select id="selectBoardList" resultType="boardDTO">
	  	<![CDATA[
 		
 		SELECT
	 			bId, 
	 			bName, 
	 			bTitle, 
	 			bContent, 
	 			bDate, 
	 			bHit 
 		FROM 
 				MVC_BOARD
 		ORDER BY 
 				bId desc
	 	]]>
	</select>

	<!-- NVL함수 NVL(value,1)  -> value가 null 일경우 1을 반환
         	그렇지 않을경우 value값을 반환
 	-->
	<insert id="insertBoardList">
    	<![CDATA[
		   INSERT INTO MVC_BOARD (
				bId, 
				bName, 
				bTitle, 
				bContent, 
				bHit
				) 
				VALUES (
				mvc_board_seq.nextval,
				#{bName},
				#{bTitle},
				#{bContent},
				0
				)
    	]]>
	</insert>

	<select id="contentView" parameterType="int" resultType="boardDTO">
    	<![CDATA[
		  SELECT * FROM 
		  	mvc_board 
		  WHERE 
		  	bId=#{bId}
		]]>
	</select>
	
	<!-- update하고 list.jsp를 호출하기때문에 -->
	<update id="update" parameterType="boardDTO">
    	<![CDATA[
		  UPDATE 
		  	mvc_board 
		  SET 
		  	bName=#{bName},
		  	bTitle=#{bTitle},
		  	bContent=#{bContent} 
		  WHERE 
		  	bId=#{bId}
		]]>
	</update>

	<update id="updateHit" parameterType="int">
   		<![CDATA[
  			UPDATE 
  				mvc_board 
  			SET 
  				bHit=bHit+1 
  			WHERE 
  				bId=#{bId}
  		]]>
	</update>

	<delete id="delete">
    	<![CDATA[
  			DELETE 
  			FROM 
  				mvc_board 
  			WHERE 
  				bId=#{bId}
  		]]>
	</delete>
	
	<select id="searchSelect" resultType="boardDTO">
		SELEFT * from( SELECT ROWNUM rownum , B.* from ( SELECT * FROM borad2<include refid="search"></include>)B)FROM board2
			WHERE between #{start} and {end}
			ORDER BY bnon des
	</select>
	
	<sql id="search"><!-- choose 옵션선택 keyword검색단어 -->
		<choose>
			<when test="choose == 'entity'">
				WHERE 
					   keyword like '%'||#{keyword}||'%'
					   keyword2 like '%'||#{keyword}||'%'
					   keyword3 like '%'||#{keyword}||'%'
					   keyword4 like '%'||#{keyword}||'%'
					   keyword5 like '%'||#{keyword}||'%'
				OR
			</when>
			
			<otherwise>
				 ${choose} like '%'||#{keyowrd}||'%'
			</otherwise>
		</choose>
	</sql>
</mapper>
  